# 모델 학습 프레임워크 데이터셋 지원

지원 데이터 셋 (기존 YOLOv7 공식 github로 배포된 프레임워크에서 정상적으로 수행 확인)

- MS COCO 2017 (학습 클래스 선택 가능)
- PASCAL VOC 2012 (학습 클래스 선택 가능)
- VISDRONE 2019 (학습 클래스 선택 가능)
- Cityscape (vehicle, person, traffic sign, traffic light 4개 클래스 학습 지원)

## 프레임워크 사용법

### 모델 학습 방법

1)  [train.py](http://train.py) 파일 내부 argparse의 --data 속성에 학습에 사용할 데이터 셋 지정 

지원하는 데이터셋 yaml 파일 목록 

- data/coco.yaml
- data/pascal.yaml
- data/visdrone.yaml
- data/cityscapes.yaml

argparse에 학습할 데이터셋 yaml 파일을 지정한 뒤 다음 명령어로 학습 수행 

```bash
python train.py 
```

위 명령어를 실행하게 되면 커스텀 데이터 셋 구성을 위한 전처리 과정이 선행되고, 작업이 완료되면 구성된 커스텀 데이터 셋으로 모델 학습이 시작된다 

### 프레임워크 주의사항

- Pascal voc 및 MS-COCO 데이터의 경우 데이터 다운로드 및 전처리를 모두 지원한다.
- visdrone 및 cityscapes 데이터는 미리 압축파일을 다운받아 프로젝트 폴더에 다음과 같이 위치시켜야한다.
    
    visdrone의 경우 공식 홈페이지를 통해 다운받으면 되고,
    
    cityscapes는 아래 주소를 통해 데이터를 다운받는다 
    → [https://drive.google.com/uc?id=1GPueFgeVyHZBLc88fyjL6nSem_9lpAe9](https://drive.google.com/uc?id=1GPueFgeVyHZBLc88fyjL6nSem_9lpAe9)
    
    ![Untitled](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled.png)
    
- CItyscapes 데이터 전처리 과정중 뜨는 “no Label ..” 문구는 전처리 과정중 생기는 문구로 모듈이 정상적으로 동작하는 것이니 걱정하지 않으셔도 됩니다.
- 모든 데이터 셋은 “(데이터 셋 명) Devkit” 이름의 폴더 내에서 압축이 풀리며, 데이터 셋마다 지정된 폴더명으로 이미지와 라벨파일이 생성된다 (절대 수정 x)
- 생성된 각 데이터 셋 별 폴더 구조는 다음과 같이 구성된다 
(아래 그림은 cityscapes 데이터셋 전저리 결과 예시)
    
    ![Untitled](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%201.png)
    

### 커스텀 데이터 셋 구성 방법

데이터 셋 별 커스텀 클래스 선택은 아래와 같은 과정으로 설정한다. (cityscapes는 선택 불가 )

1. **yaml 파일 수정** 
    
    아래 그림은 coco.yaml 파일 수정 예시를 나타낸다. 
    
    nc는 클래스 수를 의미하며, 아래 names에는 학습할 클래스의 이름을 지정하면된다 
    
    ![Untitled](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%202.png)
    

1. **(데이터셋 명).py 수정** 
    
    메인 디렉토리 안에 있는 coco.py, pascal.py, visdrone.py의 custom_cls 부분을 학습할 클래스  이름들로 지정해주어야 한다.
    
    ( yaml 파일에서 지정한 클래스 리스트와 동일하게 설정)
    
    ![Untitled](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%203.png)
    

### 전처리 과정을 거친 후 생성된 데이터 셋 예시

![<MS COCO 2017 예시> ](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%204.png)

<MS COCO 2017 예시> 

![<Pascal VOC 2012 예시>](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%205.png)

<Pascal VOC 2012 예시>

![<Visdrone 2019 예시> ](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled%206.png)

<Visdrone 2019 예시> 

![<Cityscapes 데이터 예시> ](%E1%84%86%E1%85%A9%E1%84%83%E1%85%A6%E1%86%AF%20%E1%84%92%E1%85%A1%E1%86%A8%E1%84%89%E1%85%B3%E1%86%B8%20%E1%84%91%E1%85%B3%E1%84%85%E1%85%A6%E1%84%8B%E1%85%B5%E1%86%B7%E1%84%8B%E1%85%AF%E1%84%8F%E1%85%B3%20%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%E1%84%89%E1%85%A6%E1%86%BA%20%E1%84%8C%E1%85%B5%E1%84%8B%E1%85%AF%E1%86%AB%20a3e4ed53721a4fbfafdcde3fea24ebc6/Untitled.jpeg)

<Cityscapes 데이터 예시> 

모든 데이터가 지정된 클래스에 대해서만 라벨을 구성한 것을 확인할 수 있으며, 

마지막 Cityscapes 사진 예시에서도 데이터셋이 지정한 4개의 클래스에 대해서만 라벨을 표시하는 것을 확인할 수 있다.